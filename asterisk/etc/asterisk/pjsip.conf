; pjsip.conf – конфигурация для 1001 + Билайн

[global]
type=global
endpoint_identifier_order=username,ip,anonymous

; ===== ТРАНСПОРТ UDP =====
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
external_media_address=109.172.46.197
external_signaling_address=109.172.46.197
local_net=172.16.0.0/12
local_net=10.0.0.0/8
local_net=192.168.0.0/16

; ===== AOR 1001 =====
[1001]
type=aor
max_contacts=1
remove_existing=yes
remove_unavailable=yes
default_expiration=60
qualify_frequency=30
qualify_timeout=3.0

; ===== AUTH 1001 =====
[1001]
type=auth
auth_type=userpass
username=1001
password=1001pass

; ===== ENDPOINT 1001 =====
[1001]
type=endpoint
context=from-internal
disallow=all
allow=alaw
allow=ulaw
allow=slin16
transport=transport-udp
auth=1001
aors=1001
direct_media=no
dtmf_mode=rfc4733
rewrite_contact=yes
rtp_symmetric=yes
force_rport=yes
rtp_keepalive=5

; ===== БИЛАЙН SIP ТРАНК =====

; AUTH для Билайн (для registration outbound)
[beeline-auth]
type=auth
auth_type=userpass
username=SIP030FQU0451O@ip.beeline.ru
password=ZAQ12wsx-

; AOR для Билайн (для outbound)
[beeline-aor]
type=aor
contact=sip:SIP030FQU0451O@ip.beeline.ru
qualify_frequency=30
qualify_timeout=5.0

; REGISTER для Билайн (outbound only)
[beeline-reg]
type=registration
transport=transport-udp
outbound_auth=beeline-auth
server_uri=sip:ip.beeline.ru:5060
client_uri=sip:SIP030FQU0451O@ip.beeline.ru
retry_interval=60
expiration=300
contact_user=SIP030FQU0451O

; IDENTIFY для матчинга входящих от Билайн по IP
[beeline-in-identify]
type=identify
endpoint=beeline-in
match=185.243.5.36
match=51.91.168.102
match=84.201.137.0

; AOR для ВХОДЯЩИХ от Билайн (пустой, для inbound)
[beeline-in-aor]
type=aor
remove_existing=yes
remove_unavailable=yes
max_contacts=1

; ENDPOINT для ВХОДЯЩИХ от Билайн
; Рабочая конфигурация из telephonization.ru (октябрь 2023)
[beeline-in]
type=endpoint
context=from-beeline
disallow=all
allow=alaw
allow=ulaw
allow=gsm
transport=transport-udp
aors=beeline-in-aor
direct_media=no
dtmf_mode=auto
rewrite_contact=yes
rtp_symmetric=yes
force_rport=yes
rtp_keepalive=0
from_user=SIP030FQU0451O
from_domain=ip.beeline.ru
media_address=109.172.46.197
trust_id_inbound=yes
inband_progress=yes
language=ru

; ENDPOINT для ИСХОДЯЩИХ на Билайн (с auth)
; Рабочая конфигурация из telephonization.ru (октябрь 2023)
[beeline-out]
type=endpoint
context=from-internal
disallow=all
allow=alaw
allow=ulaw
allow=gsm
transport=transport-udp
auth=beeline-auth
outbound_auth=beeline-auth
aors=beeline-aor
direct_media=no
dtmf_mode=auto
rewrite_contact=yes
rtp_symmetric=yes
force_rport=yes
rtp_keepalive=0
from_user=SIP030FQU0451O
from_domain=ip.beeline.ru
media_address=109.172.46.197
inband_progress=yes
language=ru
