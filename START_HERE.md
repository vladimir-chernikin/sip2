# üöÄ –ó–ê–ü–£–°–ö PROJE–ö–¢–ê - –ò–ù–°–¢–†–£–ö–¶–ò–Ø

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–≤—Å–µ –≤ /asterisk)

```
/asterisk/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ .env                        # OPENAI_API_KEY
‚îú‚îÄ‚îÄ asterisk/                   # –ö–æ–Ω—Ñ–∏–≥–∏ Asterisk
‚îÇ   ‚îî‚îÄ‚îÄ etc/asterisk/
‚îÇ       ‚îú‚îÄ‚îÄ pjsip.conf          # SIP —Å –±–µ–ª—ã–º IP 109.172.46.197
‚îÇ       ‚îú‚îÄ‚îÄ extensions.conf     # –ù–æ–º–µ—Ä 7000 ‚Üí AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
‚îÇ       ‚îú‚îÄ‚îÄ ari.conf            # ARI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ backend/                    # FastAPI ARI –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ media_sockets/              # OpenAI Realtime –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ instructions.md         # –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
‚îî‚îÄ‚îÄ docs/                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## ‚úÖ –ß–¢–û –£–ñ–ï –ù–ê–°–¢–†–û–ï–ù–û

### 1. üîê –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- **Fail2ban**: –ë–∞–Ω–∏—Ç IP –Ω–∞ 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- **IPTables**: Rate limit SIP –ø–æ—Ä—Ç–∞ 5060: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞
- **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏

### 2. üåê –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–ë–µ–ª—ã–π IP**: `109.172.46.197`
- **SIP –ø–æ—Ä—Ç**: `5060/UDP`
- **ARI –ø–æ—Ä—Ç**: `8088/TCP`
- **RTP –ø–æ—Ä—Ç—ã**: `10000-10100/UDP`

### 3. üîë API –∫–ª—é—á–∏
- **OpenAI API**: –î–æ–±–∞–≤–ª–µ–Ω –≤ `.env`

### 4. üê≥ Docker –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **asterisk**: 0.5 CPU, 512MB RAM
- **backend**: 0.5 CPU, 512MB RAM
- **audiosocket**: 1.0 CPU, 1GB RAM

---

## üöÄ –ó–ê–ü–£–°–ö –ü–†–û–ï–ö–¢–ê

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á
```bash
cat /asterisk/.env
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å: `OPENAI_API_KEY=sk-proj-...`

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
cd /asterisk
docker compose up -d
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
```bash
# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps

# –õ–æ–≥–∏ Asterisk
docker logs -f asterisk

# –õ–æ–≥–∏ backend
docker logs -f backend

# –õ–æ–≥–∏ audiosocket
docker logs -f audiosocket
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞—â–∏—Ç—É
```bash
# Fail2ban jails
fail2ban-client status

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
systemctl status docker-log-asterisk.service
```

---

## üì± –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï SIP –ö–õ–ò–ï–ù–¢–ê

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ MicroSIP/Zoiper:
- **–°–µ—Ä–≤–µ—Ä**: `109.172.46.197`
- **–ü–æ—Ä—Ç**: `5060`
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: `UDP`
- **Username**: `1001`
- **Password**: `1001pass` ‚ö†Ô∏è **–°–ú–ï–ù–ò–¢–ï –ù–ê –°–õ–û–ñ–ù–´–ô!**

### –ü–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞ –Ω–æ–º–µ—Ä: `7000`

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—â–∏—Ç—É:
```bash
# –°—Ç–∞—Ç—É—Å fail2ban
fail2ban-client status asterisk-sip

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP
iptables -L -n | grep DROP

# –õ–æ–≥–∏ –∞—Ç–∞–∫
tail -f /var/log/docker/asterisk.log
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
# –°—Ç–∞—Ç—É—Å
docker compose ps

# –†–µ—Å—É—Ä—Å—ã
docker stats

# –õ–æ–≥–∏
docker compose logs -f
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–î–ê–ß–ò

### 1. –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å SIP!
```bash
nano /asterisk/asterisk/etc/asterisk/pjsip.conf
# –ù–∞–π–¥–∏—Ç–µ password=1001pass –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–ª–æ–∂–Ω—ã–π
```

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É
```bash
# –ü–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞ 7000 –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
```bash
tail -f /var/log/docker/asterisk.log
```

---

## üîß –£–ü–†–ê–í–õ–ï–ù–ò–ï

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:
```bash
cd /asterisk
docker compose down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
docker compose restart
```

### –û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
docker compose up -d --build
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- `PROTECTION_FULL.md` - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã
- `SECURITY_SETUP.md` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `README.md` - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

---

## üÜò –¢–£–ú–ë–õ–ï–†–ò

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| –ù–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è SIP | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ pjsip.conf |
| –ù–µ—Ç –∑–≤—É–∫–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã 10000-10100 –≤ firewall |
| –ù–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ OPENAI_API_KEY –≤ .env |
| –ë–∞–Ω—è—Ç –≤–∞—à IP | `fail2ban-client set asterisk-sip unbanip YOUR_IP` |

---

## ‚úÖ –ì–û–¢–û–í–û –ö –ó–ê–ü–£–°–ö–£

```bash
cd /asterisk
docker compose up -d
```

–ü–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞ **7000** –∏ –Ω–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º!
